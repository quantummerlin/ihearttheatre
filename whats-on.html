<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What's On | iHeartTheatre.com</title>
    <meta name="description" content="What's on in Melbourne theatre right now. Current and upcoming shows, musicals, plays, family productions and more across Melbourne's vibrant theatre scene.">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="stylesheet" href="css/shared.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .page-header {
            padding: 120px 20px 60px;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .page-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 700;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #f5f5f5 0%, #a0a0b0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .content-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px 80px;
            position: relative;
            z-index: 2;
        }

        /* Filter bar */
        .filter-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 48px;
        }

        .filter-btn {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-secondary);
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.9rem;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            border-color: rgba(102, 126, 234, 0.3);
            color: var(--text-primary);
        }

        .filter-btn.active {
            background: var(--gradient-primary);
            border-color: transparent;
            color: white;
            font-weight: 600;
        }

        /* Time section headers */
        .time-section {
            margin-bottom: 48px;
        }

        .time-section-header {
            font-family: 'Playfair Display', serif;
            font-size: 1.6rem;
            color: var(--text-primary);
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--glass-border);
        }

        .time-section-header span {
            color: var(--accent-primary);
            font-size: 0.85rem;
            font-family: 'Inter', sans-serif;
            font-weight: 400;
            margin-left: 12px;
        }

        /* Show cards */
        .shows-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 24px;
        }

        .show-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .show-card:hover {
            border-color: rgba(102, 126, 234, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .show-card-image {
            width: 100%;
            height: 200px;
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }

        .show-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .show-card-image .placeholder {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: var(--accent-primary);
            opacity: 0.4;
        }

        .show-status {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 5px 14px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .show-status.now-showing {
            background: rgba(102, 126, 234, 0.9);
            color: white;
        }

        .show-status.coming-soon {
            background: rgba(255, 215, 0, 0.9);
            color: #1a1a2e;
        }

        .show-status.closing-soon {
            background: rgba(255, 107, 107, 0.9);
            color: white;
        }

        .show-card-body {
            padding: 24px;
        }

        .show-card-category {
            display: inline-block;
            color: var(--accent-primary);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .show-card-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .show-card-meta {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 16px;
        }

        .show-card-meta .meta-line {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .meta-line .label {
            color: var(--accent-primary);
            font-weight: 600;
            font-size: 0.8rem;
            min-width: 55px;
        }

        .show-card-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .show-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }

        .show-card-footer .price {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .show-card-footer .price strong {
            color: var(--accent-gold);
        }

        .btn-show {
            display: inline-block;
            padding: 10px 20px;
            background: var(--gradient-primary);
            color: white;
            border-radius: 25px;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-show:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        /* Reviewed badge */
        .reviewed-badge {
            display: inline-block;
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.2);
            color: var(--accent-primary);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .reviewed-badge:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.4);
        }

        /* Submit CTA */
        .submit-cta {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 48px;
            text-align: center;
            margin-top: 64px;
        }

        .submit-cta h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin-bottom: 12px;
        }

        .submit-cta p {
            color: var(--text-secondary);
            margin-bottom: 24px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .submit-cta .cta-buttons {
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        /* No shows message */
        .no-shows {
            display: none;
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .shows-grid {
                grid-template-columns: 1fr;
            }

            .submit-cta {
                padding: 32px 20px;
            }

            .show-card-footer {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar"></div>
    <div class="particles" id="particles"></div>

    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo">iHeartTheatre</a>
            <div class="hamburger" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="whats-on.html" class="active">What's On</a>
                <a href="reviews.html">Reviews</a>
                <a href="reviewers.html">Reviewers</a>
                <a href="junior-kids-schools.html">Junior & Kids</a>
                <a href="holiday-programs.html">Holiday Programs</a>
                <a href="about.html">About</a>
                <a href="contact.html">Contact</a>
            </div>
        </div>
    </nav>

    <section class="page-header">
        <h1>What's On in Melbourne</h1>
        <p>Current and upcoming theatre, musicals, plays and live performances across Melbourne</p>
    </section>

    <div class="content-wrapper">
        <div class="filter-bar" id="filterBar">
            <button class="filter-btn active" data-category="all">All Shows</button>
            <button class="filter-btn" data-category="Musical">Musicals</button>
            <button class="filter-btn" data-category="Play">Plays</button>
            <button class="filter-btn" data-category="Family">Family</button>
            <button class="filter-btn" data-category="Comedy">Comedy</button>
            <button class="filter-btn" data-category="Cabaret">Cabaret</button>
            <button class="filter-btn" data-category="Kids">Kids</button>
        </div>

        <div id="showsContainer">
            <!-- Dynamically populated -->
        </div>

        <div class="no-shows" id="noShows">
            <h3>No shows match that filter</h3>
            <p>Try selecting a different category, or check back soon as we update listings regularly.</p>
        </div>

        <div class="submit-cta">
            <h2>Got a Show Coming Up?</h2>
            <p>We'd love to help you reach Melbourne's theatre community. Submit your show details and we'll add it to our listings.</p>
            <div class="cta-buttons">
                <a href="submit-show.html" class="btn btn-primary">Submit Your Show</a>
                <a href="promote-show.html" class="btn btn-secondary">Promote Your Show</a>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <a href="index.html">Home</a>
                <a href="reviewers.html">Reviewers</a>
                <a href="reviews.html">Reviews</a>
                <a href="about.html">About</a>
                <a href="privacy.html">Privacy</a>
                <a href="disclaimer.html">Disclaimer</a>
                <a href="contact.html">Contact</a>
            </div>
            <p class="footer-copy">&copy; 2026 iHeartTheatre &bull; The Theatre Renaissance Has Already Started</p>
        </div>
    </footer>

    <div id="pwa-install-banner" class="pwa-install-banner">
        <img src="icons/icon-96x96.png" alt="iHeartTheatre" class="pwa-icon">
        <div class="pwa-text">
            <h4>Install iHeartTheatre</h4>
            <p>Add to home screen for the best experience</p>
        </div>
        <button class="pwa-install-btn" onclick="installPWA()">Install</button>
        <button class="pwa-dismiss" onclick="dismissPWA()">&times;</button>
    </div>
    <button id="backToTop" class="back-to-top" aria-label="Back to top">&uarr;</button>

    <script>
        // ===========================================
        // What's On â€” Show Listings Data
        // ===========================================
        // To add a new show, add an object to this array.
        // Fields: title, venue, dates, endDate (YYYY-MM-DD), category, description, price, ticketUrl, image (optional), reviewUrl (optional)

        const shows = [
            {
                title: 'Mamma Mia!',
                venue: 'Princess Theatre',
                dates: 'Now showing',
                endDate: '2026-06-30',
                category: 'Musical',
                description: 'The smash-hit musical based on the songs of ABBA returns to Melbourne. A mother, a daughter, three possible dads, and a trip down the aisle on a Greek island paradise.',
                price: 'From $70',
                ticketUrl: '#',
                reviewUrl: 'reviews/review-deanna-mamma-mia.html'
            },
            {
                title: 'Mary Poppins',
                venue: 'Her Majesty\'s Theatre',
                dates: 'Now showing',
                endDate: '2026-05-15',
                category: 'Musical',
                description: 'Disney and Cameron Mackintosh\'s supercalifragilistic musical. A practically perfect production that brings the magic of Cherry Tree Lane to life on stage.',
                price: 'From $65',
                ticketUrl: '#',
                reviewUrl: 'reviews/review-deanna-mary-poppins.html'
            },
            {
                title: 'Into the Woods Jr.',
                venue: 'National Theatre',
                dates: 'March 2026',
                endDate: '2026-03-28',
                category: 'Family',
                description: 'A junior production of Sondheim\'s beloved fairy-tale musical, performed by an outstanding young cast. Be careful what you wish for.',
                price: 'From $25',
                ticketUrl: '#',
                reviewUrl: 'reviews/review-penelope-into-the-woods-jr.html'
            },
            {
                title: 'Romeo and Juliet',
                venue: 'Arts Centre Melbourne',
                dates: 'March &ndash; April 2026',
                endDate: '2026-04-20',
                category: 'Play',
                description: 'Shakespeare\'s timeless tragedy of star-crossed lovers, reimagined for a contemporary audience. A powerful and moving production.',
                price: 'From $55',
                ticketUrl: '#',
                reviewUrl: 'reviews/review-deanna-romeo-and-juliet.html'
            },
            {
                title: 'Seussical the Musical',
                venue: 'The Concourse, Chatswood',
                dates: 'April 2026',
                endDate: '2026-04-30',
                category: 'Kids',
                description: 'The Cat in the Hat narrates the story of Horton the Elephant, who discovers Whos on a speck of dust. A colourful, energetic show perfect for young audiences.',
                price: 'From $30',
                ticketUrl: '#',
                reviewUrl: 'reviews/review-deanna-seussical-the-musical.html'
            },
            {
                title: 'The Little Mermaid Junior',
                venue: 'MLC School Theatre',
                dates: 'May 2026',
                endDate: '2026-05-30',
                category: 'Kids',
                description: 'Disney\'s enchanting undersea adventure adapted for young performers. Join Ariel as she dreams of life on land in this sparkling junior production.',
                price: 'From $20',
                ticketUrl: '#',
                reviewUrl: 'reviews/review-penelope-the-little-mermaid-junior.html'
            },
            {
                title: 'Bubble Laboratory',
                venue: 'Melbourne International Comedy Festival',
                dates: 'March &ndash; April 2026',
                endDate: '2026-04-20',
                category: 'Family',
                description: 'A mesmerising family show featuring incredible bubble artistry. Science meets spectacle in this interactive experience that delights audiences of all ages.',
                price: 'From $30',
                ticketUrl: '#',
                reviewUrl: 'reviews/review-deanna-bubble-laboratory.html'
            },
            {
                title: 'Circus Oz: Non-Stop',
                venue: 'Arts Centre Melbourne',
                dates: 'April 2026',
                endDate: '2026-04-30',
                category: 'Circus',
                description: 'Australia\'s legendary contemporary circus returns with a high-energy, non-stop show of acrobatics, comedy, and breathtaking skill.',
                price: 'From $45',
                ticketUrl: '#'
            }
        ];

        // ===========================================
        // Rendering Logic
        // ===========================================
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        function getShowStatus(endDate) {
            const end = new Date(endDate);
            const diffDays = Math.ceil((end - today) / (1000 * 60 * 60 * 24));

            if (diffDays < 0) return { label: 'Finished', class: 'finished', sort: 3 };
            if (diffDays <= 14) return { label: 'Closing Soon', class: 'closing-soon', sort: 0 };
            return { label: 'Now Showing', class: 'now-showing', sort: 1 };
        }

        function renderShows(filter) {
            const container = document.getElementById('showsContainer');
            const noShows = document.getElementById('noShows');

            // Filter out finished shows and apply category filter
            let filtered = shows.filter(show => {
                const status = getShowStatus(show.endDate);
                if (status.label === 'Finished') return false;
                if (filter && filter !== 'all' && show.category !== filter) return false;
                return true;
            });

            // Sort: closing soon first, then by end date
            filtered.sort((a, b) => {
                const statusA = getShowStatus(a.endDate);
                const statusB = getShowStatus(b.endDate);
                if (statusA.sort !== statusB.sort) return statusA.sort - statusB.sort;
                return new Date(a.endDate) - new Date(b.endDate);
            });

            if (filtered.length === 0) {
                container.innerHTML = '';
                noShows.style.display = 'block';
                return;
            }

            noShows.style.display = 'none';

            // Group by status
            const closingSoon = filtered.filter(s => getShowStatus(s.endDate).class === 'closing-soon');
            const nowShowing = filtered.filter(s => getShowStatus(s.endDate).class === 'now-showing');
            const comingSoon = filtered.filter(s => getShowStatus(s.endDate).class === 'coming-soon');

            let html = '';

            if (closingSoon.length > 0) {
                html += renderSection('Closing Soon', closingSoon.length + ' show' + (closingSoon.length !== 1 ? 's' : ''), closingSoon);
            }
            if (nowShowing.length > 0) {
                html += renderSection('Now Showing', nowShowing.length + ' show' + (nowShowing.length !== 1 ? 's' : ''), nowShowing);
            }
            if (comingSoon.length > 0) {
                html += renderSection('Coming Soon', comingSoon.length + ' show' + (comingSoon.length !== 1 ? 's' : ''), comingSoon);
            }

            // If all ended up in one group, just render flat
            if (html === '') {
                html = renderSection('Current Shows', filtered.length + ' show' + (filtered.length !== 1 ? 's' : ''), filtered);
            }

            container.innerHTML = html;
        }

        function renderSection(title, subtitle, showList) {
            let html = `
                <div class="time-section">
                    <h2 class="time-section-header">${title}<span>${subtitle}</span></h2>
                    <div class="shows-grid">
            `;

            showList.forEach(show => {
                const status = getShowStatus(show.endDate);
                const reviewLink = show.reviewUrl
                    ? `<a href="${show.reviewUrl}" class="reviewed-badge">Read Our Review</a>`
                    : '';

                html += `
                    <div class="show-card" data-category="${show.category}">
                        <div class="show-card-image">
                            <div class="placeholder">${show.title.charAt(0)}</div>
                            <div class="show-status ${status.class}">${status.label}</div>
                        </div>
                        <div class="show-card-body">
                            <div class="show-card-category">${show.category}</div>
                            <h3 class="show-card-title">${show.title}</h3>
                            <div class="show-card-meta">
                                <div class="meta-line"><span class="label">Venue</span> ${show.venue}</div>
                                <div class="meta-line"><span class="label">Dates</span> ${show.dates}</div>
                            </div>
                            <p class="show-card-desc">${show.description}</p>
                            <div class="show-card-footer">
                                <span class="price"><strong>${show.price}</strong></span>
                                ${reviewLink}
                                ${show.ticketUrl && show.ticketUrl !== '#'
                                    ? `<a href="${show.ticketUrl}" class="btn-show" target="_blank" rel="noopener">Get Tickets</a>`
                                    : ''}
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `</div></div>`;
            return html;
        }

        // ===========================================
        // Filter Controls
        // ===========================================
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderShows(btn.dataset.category);
            });
        });

        // Initial render
        renderShows('all');
    </script>
    <script src="js/shared.js"></script>
</body>
</html>
